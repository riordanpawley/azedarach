# Only use Nix flake if Nix is installed
if command -v nix &> /dev/null; then
  use flake
else
  echo "Nix not found, skipping flake setup"
fi

# Load .env.local if present (personal local overrides)
if [ -f .env.local ]; then
  watch_file .env.local
  dotenv .env.local
  echo "Loaded .env.local"
fi

# Set beads workspace directory for MCP plugin
# This ensures beads MCP tools can find the workspace without manual set_context() calls
export BEADS_WORKING_DIR="$PWD"

# Disable beads daemon to prevent race conditions with multiple Claude sessions
# See az-9co for details on the bd sync race condition bug
export BEADS_NO_DAEMON=1
