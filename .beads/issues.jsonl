{"id":"az-05y","title":"Project Foundation","description":"Set up the core project infrastructure: TypeScript, Ink, CLI scaffolding, and foundational utilities.","notes":"Session 2025-12-11:\n\nEPIC PROGRESS: 3/4 tasks completed (75%)\n\nCOMPLETED CHILDREN:\n- az-ags: Project scaffolding ‚úÖ\n- az-fvj: BeadsClient Effect service ‚úÖ\n- az-kis: Utility modules ‚úÖ\n\nREMAINING:\n- az-2qy: CLI argument parsing with @effect/cli (ready to start)\n\nPHASE 1 DELIVERABLES:\n- Full project infrastructure with Bun + Effect + OpenTUI + SolidJS\n- Working CLI entry point (./bin/az.ts)\n- Core services: BeadsClient, TmuxService, TerminalService\n- Custom effect-atom SolidJS adapter (az-mq9, separate from this epic)\n\nNEXT SESSION:\n- Complete az-2qy (CLI parsing) to close this epic\n- Then move to Phase 2: TUI components (az-pza epic)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-11T14:44:04.657366+11:00","updated_at":"2025-12-12T10:24:42.833983+11:00","closed_at":"2025-12-12T10:24:42.833983+11:00"}
{"id":"az-06p","title":"TUI polish: card heights, priority labels, sticky action mode","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:23:49.590359+11:00","updated_at":"2025-12-12T10:23:55.435441+11:00","closed_at":"2025-12-12T10:23:55.435441+11:00"}
{"id":"az-2ek","title":"Add warning glyphs to TaskCard header","description":"Add tiny warning glyphs (‚ö†üîÑ) to TaskCard headerLine after session indicator. ‚ö† for context warning (\u003e70%), üîÑ for recently compacted. Space cost: 1-2 characters.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-12T13:24:59.779379+11:00","updated_at":"2025-12-12T13:25:20.429502+11:00","dependencies":[{"issue_id":"az-2ek","depends_on_id":"az-dqt","type":"blocks","created_at":"2025-12-12T13:25:26.178601+11:00","created_by":"daemon"}]}
{"id":"az-2il","title":"Agent Mail status broadcast integration","description":"Workers broadcast status via Agent Mail for real-time TUI updates.\n\n**Events:**\n- STARTED: Worker began task\n- PROGRESS: Periodic heartbeat with context %\n- BLOCKED: Worker discovered blocker\n- COMPLETED: Worker finished task\n- ERROR: Worker encountered error\n\n**TUI subscription:**\n- Poll Agent Mail for status updates (or WebSocket if available)\n- Update TaskCard session indicators in real-time\n- Show toast for important events (blocked, error)\n\n**Depends on:** Agent Mail integration (az-l7a)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:29:15.170002+11:00","updated_at":"2025-12-12T16:18:33.067335+11:00","dependencies":[{"issue_id":"az-2il","depends_on_id":"az-l7a","type":"blocks","created_at":"2025-12-12T13:29:24.916405+11:00","created_by":"daemon"},{"issue_id":"az-2il","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.86955+11:00","created_by":"daemon"}]}
{"id":"az-2qy","title":"CLI argument parsing with @effect/cli","description":"Set up CLI entry point with argument parsing for the az command.","design":"- Use @effect/cli for type-safe argument parsing\n- Define Commands with Args and Options\n- Commands: az (default TUI), az start \u003cid\u003e, az attach \u003cid\u003e, az pause \u003cid\u003e, az status, az sync\n- Accept optional project path argument via Args.directory\n- Use Options for flags like --verbose, --config\n- Validate beads database exists before starting\n- Auto-generate shell completions (bash, zsh, fish)","notes":"Implemented complete CLI structure with @effect/cli:\n- Created src/cli/index.ts with all commands (default, start, attach, pause, status, sync)\n- Proper Option.Option handling for optional parameters\n- Type-safe argument parsing using Args and Options from @effect/cli\n- Integration with BeadsClient and BunContext\n- Help system auto-generates for all commands\n\nNOTE: Discovered potential issue with @effect/cli 0.72.1 where subcommands show help instead of executing. The CLI structure is correct per official docs, but runtime behavior needs investigation. Commands are properly registered (visible in help output) but not routing correctly.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:26.3098+11:00","updated_at":"2025-12-11T18:03:13.670101+11:00","closed_at":"2025-12-11T18:03:13.670101+11:00","dependencies":[{"issue_id":"az-2qy","depends_on_id":"az-05y","type":"parent-child","created_at":"2025-12-11T14:46:07.891408+11:00","created_by":"daemon"},{"issue_id":"az-2qy","depends_on_id":"az-ags","type":"blocks","created_at":"2025-12-11T14:46:25.453515+11:00","created_by":"daemon"}]}
{"id":"az-385","title":"Indented child task display under epics","description":"Show epic children indented in the board view.\n\n**Visual:**\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ üéØ az-epic      ‚îÇ\n‚îÇ   ‚îú‚îÄ az-a ‚öô    ‚îÇ\n‚îÇ   ‚îú‚îÄ az-b ‚úì    ‚îÇ\n‚îÇ   ‚îî‚îÄ az-c ‚è∏    ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n**Implementation:**\n- Query parent field from beads\n- Group tasks by parent in Board.tsx\n- Render children with tree prefix (‚îú‚îÄ ‚îî‚îÄ)\n- Collapse/expand with Enter on epic?\n\n**Consideration:** May need variable card heights or separate epic view","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-12T13:29:15.298636+11:00","updated_at":"2025-12-12T13:29:15.298636+11:00","dependencies":[{"issue_id":"az-385","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.905066+11:00","created_by":"daemon"}]}
{"id":"az-3rk","title":"Add rate_limited session state","description":"Add 'rate_limited' to SessionState type and SESSION_INDICATORS map (‚è± glyph). Extend StateDetector patterns to detect rate limiting from Claude output (patterns like 'Rate limit', 'Too many requests', 'Please wait').","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:24:59.309325+11:00","updated_at":"2025-12-12T13:25:19.967333+11:00"}
{"id":"az-4r0","title":"AgentMailClient Effect service","description":"Create Effect service wrapper for Agent Mail HTTP API.\n\nDesign:\n- Define AgentMailClient as Effect.Service\n- Use @effect/platform HttpClient for requests\n- Methods:\n  - reserve(issueId): Effect\u003cReservation, ReservationError\u003e\n  - release(issueId): Effect\u003cvoid, ReleaseError\u003e\n  - ready(): Effect\u003cIssue[], AgentMailError\u003e\n  - updateStatus(issueId, status): Effect\u003cvoid, AgentMailError\u003e\n  - isAvailable(): Effect\u003cboolean, never\u003e (health check)\n- Read config from environment variables\n- Graceful degradation: return fallback when server unavailable\n- Retry logic with exponential backoff\n- Create AgentMailClientLive and AgentMailClientTest layers","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T10:33:13.475812+11:00","updated_at":"2025-12-12T10:33:13.475812+11:00","dependencies":[{"issue_id":"az-4r0","depends_on_id":"az-l7a","type":"blocks","created_at":"2025-12-12T10:33:21.800097+11:00","created_by":"daemon"}]}
{"id":"az-53o","title":"Notification system (terminal bell, system notifications)","description":"Alert user when sessions need attention.","design":"- Define NotificationService as Effect.Service\n- Methods:\n  - notify(title, body, urgency): Effect\u003cvoid, NotificationError\u003e\n  - bell(): Effect\u003cvoid\u003e // terminal bell \\x07\n- Notification backends:\n  - macOS: osascript via @effect/platform Command\n  - Cross-platform fallback: node-notifier (optional dep)\n- Use Effect.race with timeout for notification delivery\n- Notification triggers: subscribe to SessionManager PubSub\n- Configurable via Config service:\n  - enable/disable per event type\n  - sound option\n  - cooldown duration\n- Use Schedule.spaced for cooldown to prevent spam","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:24.717497+11:00","updated_at":"2025-12-11T14:54:42.593575+11:00","dependencies":[{"issue_id":"az-53o","depends_on_id":"az-zv6","type":"parent-child","created_at":"2025-12-11T14:46:09.727137+11:00","created_by":"daemon"}]}
{"id":"az-5p5","title":"Add session metrics section to DetailPanel","description":"Add Session Metrics section to DetailPanel modal showing: Context % with warning indicator, session duration, estimated token count. Only visible when session is active (not idle).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:24:59.666185+11:00","updated_at":"2025-12-12T13:25:20.32711+11:00","dependencies":[{"issue_id":"az-5p5","depends_on_id":"az-dqt","type":"blocks","created_at":"2025-12-12T13:25:26.146395+11:00","created_by":"daemon"}]}
{"id":"az-65k","title":"Selection jumps to top of column after moving task left","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-12T17:17:04.148671+11:00","updated_at":"2025-12-12T17:19:50.167491+11:00","closed_at":"2025-12-12T17:19:50.167491+11:00"}
{"id":"az-6la","title":"Add context health border colors to TaskCard","description":"Encode context health into TaskCard border color when session is active: lavender (healthy, \u003c70%), yellow (warning, 70-90%), red (critical, \u003e90%). Requires contextPercent from TaskWithSession.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:24:59.426477+11:00","updated_at":"2025-12-12T13:25:20.07394+11:00","dependencies":[{"issue_id":"az-6la","depends_on_id":"az-dqt","type":"blocks","created_at":"2025-12-12T13:25:26.111928+11:00","created_by":"daemon"}]}
{"id":"az-6t6","title":"Manual worktree cleanup action (Space+d)","description":"Add Space+d action to manually delete a worktree and its branch.\n\n**Use cases:**\n- Abandoned work that won't be merged\n- Failed PRs that need cleanup\n- Manual housekeeping\n\n**Implementation:**\n- Add to ActionPalette with state check (only available when worktree exists)\n- Confirm dialog before deletion (destructive action)\n- WorktreeManager.remove() + git branch -D\n- Update task card to remove blue dot\n- Toast notification on success/failure\n\n**Depends on:** az-yf4 (PRWorkflow) for the cleanup utility function","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T12:26:24.70141+11:00","updated_at":"2025-12-12T12:34:29.581402+11:00","dependencies":[{"issue_id":"az-6t6","depends_on_id":"az-yf4","type":"blocks","created_at":"2025-12-12T12:26:35.152751+11:00","created_by":"daemon"}]}
{"id":"az-7sr","title":"Add orchestration mode (Space+o) to TUI","description":"New editor mode for orchestrating parallel workers on an epic.\n\n**Trigger:** Space+o when cursor is on an epic task\n**Mode behavior:**\n- Query child tasks of epic via bd\n- Display as selectable list (like select mode)\n- Space toggles task inclusion\n- Enter confirms and triggers spawn\n- Esc cancels\n\n**UI:** Reuse select mode patterns but with orchestration-specific keybinds shown in StatusBar.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:29:14.653445+11:00","updated_at":"2025-12-12T13:29:14.653445+11:00","dependencies":[{"issue_id":"az-7sr","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.732517+11:00","created_by":"daemon"}]}
{"id":"az-7vk","title":"Auto-wrap in tmux on startup","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T17:16:24.296316+11:00","updated_at":"2025-12-12T17:16:32.587438+11:00","closed_at":"2025-12-12T17:16:32.587438+11:00"}
{"id":"az-8ep","title":"Beads sync coordination for worktrees","description":"Coordinate beads sync across main repo and worktrees.","design":"- Define BeadsSyncCoordinator as Effect.Service\n- Depends on: BeadsClient, WorktreeManager, SessionManager\n- Sync strategy:\n  1. Before task start: sync (pull latest)\n  2. Periodic sync during work (configurable interval via Schedule)\n  3. On task completion: sync (push final state)\n- Methods:\n  - syncAll(): Effect\u003cSyncResult[], BeadsError\u003e\n  - syncWorktree(path): Effect\u003cSyncResult, BeadsError\u003e\n  - startPeriodicSync(interval): Effect\u003cFiber.RuntimeFiber\u003cvoid\u003e, never\u003e\n- Use Effect.retry with exponential backoff for conflicts\n- Handle sync conflicts gracefully with Effect.catchTag\n- 's' keybinding triggers syncAll()\n- Show sync status in StatusBar via Ref\u003cSyncStatus\u003e","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:24.819887+11:00","updated_at":"2025-12-12T12:17:55.89465+11:00","closed_at":"2025-12-12T12:17:55.89465+11:00","dependencies":[{"issue_id":"az-8ep","depends_on_id":"az-zv6","type":"parent-child","created_at":"2025-12-11T14:46:09.882335+11:00","created_by":"daemon"}]}
{"id":"az-9b8","title":"Epic progress indicator in TaskCard","description":"Show progress bar for epic tasks: ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 3/5\n\n**Implementation:**\n- Query child task statuses\n- Calculate completed/total\n- Render as Unicode progress bar\n- Only show for issue_type=epic\n\n**Space cost:** One line, replaces description line for epics","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-12T13:29:15.040003+11:00","updated_at":"2025-12-12T13:29:15.040003+11:00","dependencies":[{"issue_id":"az-9b8","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.835556+11:00","created_by":"daemon"}]}
{"id":"az-9ch","title":"Worktree init hooks (direnv, env vars, custom commands)","description":"Allow configuring commands to run when a worktree is created or session is started. Common use cases: direnv allow, setting env vars, installing deps, etc.","design":"Config structure (in future az config file):\n```yaml\nworktree:\n  init:\n    - direnv allow\n    - pnpm install\n  env:\n    CLAUDE_MODEL: opus\n    DEBUG: true\n```\n\nImplementation options:\n1. Run init commands after worktree creation in WorktreeManager\n2. Run init commands in the tmux session before claude starts\n3. Both (worktree-level vs session-level hooks)\n\nOption 2 is simpler - modify the session command:\n```\n$SHELL -c 'direnv allow \u0026\u0026 claude; exec $SHELL'\n```\n\nFor env vars, use tmux set-environment or export in the shell command.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T12:13:03.534484+11:00","updated_at":"2025-12-12T17:24:21.906802+11:00","closed_at":"2025-12-12T17:24:21.906802+11:00","dependencies":[{"issue_id":"az-9ch","depends_on_id":"az-pnx","type":"blocks","created_at":"2025-12-12T12:13:09.239776+11:00","created_by":"daemon"}]}
{"id":"az-a8i","title":"StateDetector - Claude output pattern matching","description":"Detect Claude session state by monitoring PTY output and matching patterns.","design":"- Define StateDetector as Effect.Service\n- Use Stream from Effect to process PTY output\n- Pattern matching with priorities (higher priority wins)\n- Methods:\n  - detectFromOutput(chunk: string): Effect\u003cSessionState | null\u003e\n  - createOutputStream(pty): Stream\u003cSessionState, never\u003e\n- Use @effect/schema for pattern configuration validation\n- Default patterns for waiting, done, error states\n- Configurable patterns via Config service\n- Use Schedule for debouncing state changes\n- Emit state changes via PubSub","notes":"‚úÖ StateDetector service complete and tested.\n\nFiles created:\n- src/core/StateDetector.ts (main service)\n- src/core/StateDetector.example.ts (usage examples)\n\nFeatures implemented:\n‚úì SessionState type: idle | busy | waiting | done | error\n‚úì Effect.Service with Effect.Tag pattern\n‚úì detectFromChunk() - stateless pattern matching\n‚úì createDetector() - stateful detector with debouncing\n‚úì Priority-based pattern matching (waiting \u003e error \u003e done \u003e busy)\n‚úì StateDetectorLive layer (no dependencies)\n‚úì Convenience functions for easy usage\n‚úì Debouncing: busy state coalesces rapid output\n‚úì Terminal state stickiness: done/error persist until reset\n‚úì Comprehensive examples demonstrating all features\n\nPattern matching:\n- waiting: [y/n], 'Do you want to', 'Press Enter', etc.\n- error: 'Error:', 'Exception:', 'Failed:', 'ENOENT', etc.\n- done: 'Task completed', 'Successfully', 'Done.', etc.\n- busy: any non-empty output not matching above\n\nType checking: ‚úÖ No errors\nRuntime testing: ‚úÖ All examples run successfully","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:44.92773+11:00","updated_at":"2025-12-12T01:29:02.419812+11:00","closed_at":"2025-12-12T01:29:02.419812+11:00","dependencies":[{"issue_id":"az-a8i","depends_on_id":"az-d8z","type":"parent-child","created_at":"2025-12-11T14:46:08.44929+11:00","created_by":"daemon"}]}
{"id":"az-ags","title":"Project scaffolding with Bun, Effect, OpenTUI, and SolidJS","description":"Initialize the project with package.json, tsconfig.json (strict mode), and build tooling. Set up Ink as the TUI framework with React 18.","design":"- Use pnpm as package manager\n- **Bun runtime** (required for OpenTUI's Zig FFI)\n- TypeScript strict mode enabled\n- Effect ecosystem as core foundation:\n  - `effect` - core runtime, error handling, concurrency\n  - `@effect/platform` + `@effect/platform-bun` - Command execution, file system\n  - `@effect/cli` - CLI argument parsing\n  - `effect/Schema` - config and data validation\n  - `@effect-atom/atom` - reactive state bridging Effect to UI\n- **OpenTUI for TUI** (bleeding edge, experimental):\n  - `@opentui/core` - terminal primitives, Yoga layout\n  - `@opentui/solid` - SolidJS reconciler (actively maintained)\n  - `solid-js` - reactive UI framework\n- tsup for bundling (or Bun's bundler)\n- Create src/index.tsx entry point\n- Create bin/az.ts CLI executable\n- Set up Layer-based dependency injection from the start\n- Install Zig (required for building OpenTUI)","notes":"Session 2025-12-11:\n\nCOMPLETED:\n- package.json with Bun runtime, Effect ecosystem, OpenTUI + SolidJS\n- tsconfig.json with strict mode, SolidJS JSX config, path aliases\n- Directory structure: src/{core,lib,ui,config}, bin/\n- bin/az.ts CLI entry point (executable, runs successfully)\n- src/index.tsx placeholder with solid-js import\n- All dependencies installed via `bun install`\n\nFILES CREATED:\n- package.json - Full dependency list for Effect + OpenTUI stack\n- tsconfig.json - Strict TS with jsx: \"react-jsx\", jsxImportSource: \"solid-js\"\n- bin/az.ts - Shebang entry point\n- src/index.tsx - Placeholder entry\n\nKEY DECISIONS:\n- Using Bun (not Node) because OpenTUI requires Bun's FFI for Zig backend\n- Using pnpm despite Bun runtime (hybrid setup works)\n- tsup for bundling (simpler than esbuild config)\n\nVERIFICATION:\n- `bun run type-check` passes\n- `./bin/az.ts` outputs \"Azedarach - TUI Kanban for Claude orchestration\"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:26.210523+11:00","updated_at":"2025-12-11T17:27:44.457444+11:00","closed_at":"2025-12-11T17:25:13.896919+11:00","dependencies":[{"issue_id":"az-ags","depends_on_id":"az-05y","type":"parent-child","created_at":"2025-12-11T14:46:07.779213+11:00","created_by":"daemon"}]}
{"id":"az-aiu","title":"Implement session templates for pre-planning prompts","description":"Create .claude/session-templates/ with task-type-specific CLAUDE.md templates (feature.md, bugfix.md, refactor.md, epic.md). Templates inject 'think first' planning phase. SessionManager loads appropriate template when spawning.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:24:59.891181+11:00","updated_at":"2025-12-12T13:25:20.531813+11:00"}
{"id":"az-bjp","title":"Parallel worker spawning from orchestration mode","description":"When user confirms orchestration, spawn workers in parallel.\n\n**Implementation:**\n- Use Effect.forEach with concurrency for parallel worktree creation\n- Each worker: WorktreeManager.create ‚Üí TmuxService.newSession ‚Üí inject template\n- Reserve issues via Agent Mail (if available)\n- Track all spawned workers in SessionManager\n\n**Error handling:**\n- If any spawn fails, show toast but continue with others\n- Partial success is acceptable","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:29:14.790073+11:00","updated_at":"2025-12-12T13:29:14.790073+11:00","dependencies":[{"issue_id":"az-bjp","depends_on_id":"az-7sr","type":"blocks","created_at":"2025-12-12T13:29:24.844916+11:00","created_by":"daemon"},{"issue_id":"az-bjp","depends_on_id":"az-lqb","type":"blocks","created_at":"2025-12-12T13:29:24.88113+11:00","created_by":"daemon"},{"issue_id":"az-bjp","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.765448+11:00","created_by":"daemon"}]}
{"id":"az-c7e","title":"FileLockManager - prevent concurrent file access","description":"Implement socket-based file locking to prevent multiple Claude sessions from editing the same file simultaneously.","design":"- Define FileLockManager as Effect.Service\n- Use Unix domain socket for lock coordination (via @effect/platform)\n- Lock granularity: per-file path (normalized)\n- Methods:\n  - acquireLock(path, type): Effect\u003cLock, LockError | TimeoutError\u003e\n  - releaseLock(lock): Effect\u003cvoid, never\u003e\n  - withLock(path, type, effect): Effect\u003cA, E | LockError, R\u003e // scoped\n- Lock types: exclusive (write) vs shared (read) using Semaphore\n- Use Effect.timeout for lock acquisition timeout\n- Use Effect.ensuring for automatic lock release\n- Track locks in Ref\u003cHashMap\u003cPath, LockState\u003e\u003e\n- Handle session crash cleanup via Fiber interruption\n- Consider: advisory (warn via Logger) vs enforced (block via Deferred)\n- Socket path: /tmp/azedarach-\u003cproject-hash\u003e.sock","notes":"Implemented FileLockManager service following Effect patterns:\n\nCore implementation:\n- Service defined using Effect.Tag pattern (FileLockManager)\n- Lock types: exclusive (write) vs shared (read)\n- Error types: LockError, LockTimeoutError, LockConflictError\n- Lock state tracking via Ref\u003cHashMap\u003cPath, LockState\u003e\u003e\n\nKey methods:\n- acquireLock(path, type, timeout?, sessionId?): acquires lock or waits in queue\n- releaseLock(lock): releases lock and processes wait queue\n- getLockState(path): inspection for debugging/monitoring\n- withLock(options, effect): scoped convenience function for automatic cleanup\n\nLock semantics:\n- Exclusive locks: only one holder, blocks all other locks\n- Shared locks: multiple holders allowed, blocks exclusive locks\n- Wait queue processing: FIFO with automatic grant when compatible\n\nFeatures:\n- Effect.ensuring for automatic lock release\n- Deferred + timeoutFail for timeout handling\n- Automatic wait queue cleanup on fiber interruption\n- Path normalization for consistent lock granularity\n- Project hash for socket paths: /tmp/azedarach-\u003chash\u003e.sock\n\nFiles created:\n- src/core/FileLockManager.ts (580 lines)\n- src/core/FileLockManager.example.ts (354 lines with 8 examples)\n\nType checking: CLEAN (no errors)\nFollows patterns from: TmuxService, WorktreeManager, StateDetector","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:45.033059+11:00","updated_at":"2025-12-12T10:30:40.810809+11:00","closed_at":"2025-12-12T10:30:40.810809+11:00","dependencies":[{"issue_id":"az-c7e","depends_on_id":"az-d8z","type":"parent-child","created_at":"2025-12-11T14:46:08.562322+11:00","created_by":"daemon"}]}
{"id":"az-c9y","title":"Replace verbose StatusBar stats with compact indicators","description":"Replace verbose 'Tasks: 12  Active: 3' with compact indicators '12‚öô 3‚è∏ 2‚úó'. Expand to full text on wide terminals (‚â•100 cols). Add noteworthy alerts section that appears only when sessions need attention.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-12T13:24:59.538659+11:00","updated_at":"2025-12-12T13:25:20.220062+11:00","dependencies":[{"issue_id":"az-c9y","depends_on_id":"az-dqt","type":"blocks","created_at":"2025-12-12T13:25:26.209397+11:00","created_by":"daemon"}]}
{"id":"az-d5q","title":"Help overlay with keybinding reference","description":"Contextual help overlay showing available commands.","design":"- Toggle with '?' key\n- Show all keybindings grouped by category\n- Context-aware: highlight actions valid for selected task\n- Dismiss with any key or Escape\n- Include version info","notes":"Created HelpOverlay component with Catppuccin-themed modal showing all keybindings grouped by category (Navigation, Modes, Select Mode, Action Mode, General). Added '?' keybind to App.tsx to toggle the help overlay. The overlay dismisses on any key press. Successfully type-checked with no errors.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:41.840117+11:00","updated_at":"2025-12-12T01:29:02.41928+11:00","closed_at":"2025-12-12T01:29:02.41928+11:00","dependencies":[{"issue_id":"az-d5q","depends_on_id":"az-ee4","type":"parent-child","created_at":"2025-12-11T14:46:10.144875+11:00","created_by":"daemon"}]}
{"id":"az-d8z","title":"Session Management","description":"Core orchestration layer: git worktrees, tmux sessions, Claude spawning, state detection, and file locking to prevent concurrent access.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-11T14:44:04.762911+11:00","updated_at":"2025-12-12T10:33:37.439444+11:00","closed_at":"2025-12-12T10:33:37.439444+11:00"}
{"id":"az-dpi","title":"Integrate Agent Mail with SessionManager","description":"Wire Agent Mail into session lifecycle for automatic reservation management.\n\nDesign:\n- SessionManager.start() calls agentMail.reserve() before worktree creation\n- SessionManager.stop() calls agentMail.release() after cleanup\n- SessionManager.pause() keeps reservation but updates status\n- Add reservation info to Session type\n- Fail session start if issue already reserved by another agent\n- Handle reservation conflicts gracefully\n- Update Kanban board to show reservation status (who owns what)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T10:33:13.738474+11:00","updated_at":"2025-12-12T10:33:13.738474+11:00","dependencies":[{"issue_id":"az-dpi","depends_on_id":"az-l7a","type":"blocks","created_at":"2025-12-12T10:33:21.870895+11:00","created_by":"daemon"},{"issue_id":"az-dpi","depends_on_id":"az-4r0","type":"blocks","created_at":"2025-12-12T10:33:21.939099+11:00","created_by":"daemon"},{"issue_id":"az-dpi","depends_on_id":"az-tgc","type":"blocks","created_at":"2025-12-12T10:33:21.972727+11:00","created_by":"daemon"}]}
{"id":"az-dqt","title":"Extend TaskWithSession type with session metrics","description":"Extend TaskWithSession interface with optional session metrics: contextPercent (0-100), sessionStartedAt, estimatedTokens, lastCompactedAt, recentOutput. This is the foundation for other session metrics features.","notes":"Session 2025-12-12: Created from Claude Code best practices research.\n\nRESEARCH CONTEXT:\n- 6 parallel research agents analyzed: Anthropic blog, Reddit, latest features, orchestration tools, CLAUDE.md patterns, real-world usage\n- Key finding: Context % monitoring is critical - users hit auto-compact (95%) unexpectedly\n- Key finding: MCP servers consume 55K-134K tokens before conversation starts\n- Design: Use progressive disclosure - border colors for at-a-glance, DetailPanel for full metrics\n\nUI DESIGN DECISIONS:\n- Border color encodes context health: lavender (\u003c70%), yellow (70-90%), red (\u003e90%)\n- Only show metrics when session is active (not idle)\n- Extend existing TaskWithSession type (no new components needed)\n\nIMPLEMENTATION NOTES:\n- Add: contextPercent, sessionStartedAt, estimatedTokens, lastCompactedAt, recentOutput\n- All fields optional (populated when session active)\n- This is foundation - unblocks az-6la, az-5p5, az-2ek, az-c9y\n\nNEXT STEP: Implement type changes in src/ui/types.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-12T13:25:00.109541+11:00","updated_at":"2025-12-12T17:15:17.817934+11:00"}
{"id":"az-ee4","title":"Configuration \u0026 Polish","description":"User configuration (cosmiconfig + zod), multi-project support, help system, and final polish.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:44:05.070257+11:00","updated_at":"2025-12-11T14:44:05.070257+11:00"}
{"id":"az-foy","title":"Update docs from Ink to OpenTUI + React","description":"","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-12T17:16:24.188255+11:00","updated_at":"2025-12-12T17:16:32.49283+11:00","closed_at":"2025-12-12T17:16:32.49283+11:00"}
{"id":"az-fvj","title":"BeadsClient - wrapper around bd CLI","description":"Create a TypeScript wrapper around the bd CLI for reading and updating beads issues.","design":"- Define BeadsClient as Effect Service using Effect.Service\n- Use @effect/platform Command for shelling out to bd\n- Methods return Effect with typed errors:\n  - list(): Effect\u003cIssue[], BeadsError\u003e\n  - show(id): Effect\u003cIssue, BeadsError | NotFoundError\u003e\n  - update(id, fields): Effect\u003cvoid, BeadsError\u003e\n  - close(id): Effect\u003cvoid, BeadsError\u003e\n  - sync(): Effect\u003cSyncResult, BeadsError\u003e\n- Use @effect/schema for parsing bd --json output\n- Support running in different worktrees via workingDirectory option\n- Create BeadsClientLive layer with real implementation\n- Create BeadsClientTest layer for testing","notes":"Session 2025-12-11:\n\nCOMPLETED:\n- Full Effect service wrapping bd CLI\n- Schema validation for Issue type\n- All major bd commands wrapped with typed errors\n\nFILES CREATED:\n- src/core/BeadsClient.ts (447 lines) - Complete service\n- src/core/BeadsClient.example.ts (152 lines) - 8 usage examples\n\nSERVICE METHODS:\n- list(filters?) - List issues with status/priority/type filters\n- show(id) - Get single issue details\n- update(id, fields) - Update status/notes/priority\n- close(id, reason?) - Close issue\n- sync() - Push/pull beads database\n- ready() - Get unblocked issues\n- search(query) - Search issues\n\nERROR TYPES:\n- BeadsError - Generic bd command failures\n- NotFoundError - Issue not found\n- ParseError - JSON/Schema validation errors\n\nLAYERS:\n- BeadsClientLive - Service only (needs BunContext)\n- BeadsClientLiveWithPlatform - Complete with platform deps (recommended)\n\nVERIFICATION:\n- Type check passes\n- Runtime test fetched 10 ready issues from actual beads database","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:26.409567+11:00","updated_at":"2025-12-11T17:27:44.655776+11:00","closed_at":"2025-12-11T17:25:14.06403+11:00","dependencies":[{"issue_id":"az-fvj","depends_on_id":"az-05y","type":"parent-child","created_at":"2025-12-11T14:46:08.006035+11:00","created_by":"daemon"},{"issue_id":"az-fvj","depends_on_id":"az-ags","type":"blocks","created_at":"2025-12-11T14:46:25.575251+11:00","created_by":"daemon"}]}
{"id":"az-g19","title":"Terminal attachment (external and inline)","description":"Implement session attachment for manual intervention.","design":"- External (a): detect terminal emulator, open new window/tab with tmux attach\n- Ghostty: ghostty -e tmux attach-session -t \u003cid\u003e\n- iTerm: osascript to open new tab\n- Inline (A): replace TUI with session output, handle detach to return\n- Track which sessions user has attached to","notes":"Implementation complete:\n\n1. Created AttachmentService (src/core/AttachmentService.ts):\n   - External attachment via attachExternal() - opens new terminal window/tab\n   - Inline attachment stub via attachInline() - reserved for future implementation\n   - Terminal type detection (Ghostty, iTerm, Terminal.app)\n   - Attachment history tracking\n   - Proper Effect error handling with AttachmentError and SessionNotFoundError\n\n2. Updated atoms.ts:\n   - Added AttachmentService to runtime layer (appLayer)\n   - Created attachExternalEffect() and attachInlineEffect() helper functions\n   - Properly composed layers with dependencies (AttachmentService depends on TmuxService and TerminalService)\n\n3. Integrated with App.tsx keyboard handling:\n   - Added 'a' key in action mode (Space + a) for external attachment\n   - Added 'A' key in action mode (Space + A) for inline attachment (shows error for now)\n   - Session ID is constructed as 'claude-{task.id}'\n   - Error handling with console.error fallback\n\nTechnical details:\n- AttachmentService uses TmuxService for session validation and attach command generation\n- TerminalService provides terminal detection and command execution\n- External attachment opens new terminal with 'tmux attach-session -t {sessionId}'\n- Inline attachment is stubbed - future implementation will require suspending TUI renderer\n- All code passes type-check with strict TypeScript mode\n- No 'as' casts or 'any' types used\n\nUsage:\n1. Navigate to a task with hjkl\n2. Press Space to enter action mode\n3. Press 'a' to attach externally in new terminal window\n4. Press 'A' to attempt inline (will show error message)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:08.219579+11:00","updated_at":"2025-12-12T10:32:33.851115+11:00","closed_at":"2025-12-12T10:32:33.851115+11:00","dependencies":[{"issue_id":"az-g19","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:09.313043+11:00","created_by":"daemon"}]}
{"id":"az-gds","title":"Subagent orchestration for parallel epic development","description":"Enable TUI to orchestrate multiple parallel Claude sessions working on related tasks (e.g., epic children). Each worker runs in its own worktree/tmux session. Coordination via Agent Mail for real-time updates, beads for persistent state.\n\n**Key Features:**\n1. Space+o on epic ‚Üí orchestration mode showing child tasks\n2. Select which tasks to parallelize\n3. Spawn workers (worktree + tmux + claude per task)\n4. Workers get injected context about epic and coordination rules\n5. Real-time progress tracking via Agent Mail status broadcasts\n6. Epic progress bar showing X/Y tasks complete\n7. Optional orchestrator Claude for planning/review phases\n\n**Architecture:**\n- TUI is external orchestrator (not a Claude subagent)\n- Workers are independent Claude sessions\n- Agent Mail handles: reservations, status, completion signals\n- Beads handles: persistent notes, design decisions\n- Graceful degradation to git-only if Agent Mail unavailable\n\n**New UI:**\n- Orchestration mode (Space+o)\n- Epic progress indicator (‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 3/5)\n- Indented child tasks under epic\n- Worker status in session indicators\n\n**Session Templates:**\n- worker.md template with epic context injection\n- Coordination rules (stay focused, report discoveries)\n- Auto-close task on completion","notes":"Session 2025-12-12: Designed from Claude Code best practices research.\n\nRESEARCH VALIDATION:\n- Pattern confirmed: Git worktrees are de facto standard for parallel AI agents (Cursor, ccswarm, Claude-Flow all use this)\n- Key insight: TUI as external orchestrator avoids Claude subagent nesting limits\n- Agent Mail provides \u003c100ms coordination vs 2-5s git sync\n\nARCHITECTURE DECISIONS:\n- TUI spawns workers (not Claude spawning subagents) - no nesting limits\n- Each worker: worktree + tmux session + Claude instance\n- Agent Mail for: reservations, status broadcasts, completion signals  \n- Beads for: persistent notes, design decisions\n- Graceful degradation to git-only if Agent Mail unavailable\n\nUI DESIGN:\n- Space+o triggers orchestration mode on epics\n- Reuse select mode patterns for task selection\n- Progress bar: ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 3/5 format\n- Indented children under epics in board view\n\nDEPENDENCIES:\n- az-7sr (orch mode) + az-lqb (template) ‚Üí az-bjp (spawning)\n- az-l7a (Agent Mail epic) ‚Üí az-2il (status broadcasts)\n\nNEXT STEP: Implement az-7sr (orchestration mode) or az-lqb (worker template) - both are ready","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-12T13:28:50.911119+11:00","updated_at":"2025-12-12T16:35:31.355396+11:00"}
{"id":"az-h3v","title":"Agent Mail server for local development","description":"Implement simple Agent Mail server for local multi-agent testing.\n\nDesign:\n- Bun HTTP server with Effect\n- In-memory reservation store (Map\u003cissueId, agentName\u003e)\n- Endpoints:\n  - POST /reserve/:issueId - acquire reservation\n  - POST /release/:issueId - release reservation\n  - GET /ready - list unreserved, unblocked issues\n  - POST /status/:issueId - update status\n  - GET /health - server health check\n- WebSocket support for real-time notifications (optional)\n- Configurable port via CLI argument\n- Graceful shutdown handling","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-12T10:33:13.621222+11:00","updated_at":"2025-12-12T10:33:13.621222+11:00","dependencies":[{"issue_id":"az-h3v","depends_on_id":"az-l7a","type":"blocks","created_at":"2025-12-12T10:33:21.836567+11:00","created_by":"daemon"}]}
{"id":"az-hri","title":"Basic Kanban board component (OpenTUI + Solid)","description":"Create the main Ink-based Kanban board displaying beads issues in columns by status.","design":"- Use OpenTUI + SolidJS for components\n- App.tsx: root component, provides Effect runtime context\n- Board.tsx: horizontal flexbox layout of columns (Yoga)\n- Column.tsx: vertical list of tasks per status (open, in_progress, blocked, review, closed)\n- TaskCard.tsx: individual task with title, id, session indicator\n- Session indicators: üîµ Busy, üü° Waiting, ‚úÖ Done, ‚ùå Error, ‚è∏Ô∏è Paused\n- Use SolidJS signals for reactive state (pairs well with Effect Ref)\n- Use createResource for async data fetching from Effect services\n- Style with OpenTUI's built-in primitives (Box, Text, etc.)","notes":"Implemented basic Kanban board component with OpenTUI + SolidJS:\n\n- Created UI types (SessionState, TaskWithSession, COLUMNS, SESSION_INDICATORS)\n- TaskCard.tsx: displays individual tasks with title, ID, session indicator, priority color\n- Column.tsx: vertical list of tasks per status with header and count\n- Board.tsx: horizontal layout of columns using Yoga flexbox\n- StatusBar.tsx: bottom bar with keyboard shortcuts and stats\n- App.tsx: root component with Effect runtime, fetches tasks from BeadsClient\n- launch.tsx: TUI initialization with OpenTUI render\n\nAll components use OpenTUI primitives (box, text) with proper styling (fg/bg colors, attributes for bold, border styles). Successfully type checks with strict mode.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:07.662469+11:00","updated_at":"2025-12-11T18:03:13.707242+11:00","closed_at":"2025-12-11T18:03:13.707242+11:00","dependencies":[{"issue_id":"az-hri","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:08.667781+11:00","created_by":"daemon"},{"issue_id":"az-hri","depends_on_id":"az-ags","type":"blocks","created_at":"2025-12-11T14:46:25.898548+11:00","created_by":"daemon"},{"issue_id":"az-hri","depends_on_id":"az-fvj","type":"blocks","created_at":"2025-12-11T14:46:26.110348+11:00","created_by":"daemon"},{"issue_id":"az-hri","depends_on_id":"az-mq9","type":"blocks","created_at":"2025-12-11T17:10:08.980724+11:00","created_by":"daemon"}]}
{"id":"az-k5m","title":"Persist session state via tmux query","description":"Session state is lost on azedarach restart because SessionManager stores state in-memory Ref. Fix by querying tmux list-sessions on startup and matching session names to bead IDs.","design":"Option 1 (recommended): Query tmux as source of truth\n- On SessionManager init or listActive(), also run tmux list-sessions\n- Parse session names matching our pattern (just beadId)\n- Merge with in-memory state\n- Tmux existence = session exists, regardless of in-memory state\n\nImplementation:\n1. Add syncFromTmux() method to SessionManager\n2. Call it in listActive() before returning\n3. Or call it once on service init via Effect.sync in the Layer","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T11:33:52.363085+11:00","updated_at":"2025-12-12T11:34:33.533566+11:00","closed_at":"2025-12-12T11:34:33.533566+11:00"}
{"id":"az-kgq","title":"Multi-project support","description":"Monitor tasks across multiple beads-enabled projects.","design":"- az add /path/to/project: register project\n- az list: show registered projects\n- Combined view: tasks from all projects, grouped or mixed\n- Project selector/filter in TUI\n- Per-project configuration","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-11T14:45:41.986553+11:00","updated_at":"2025-12-11T14:45:41.986553+11:00","dependencies":[{"issue_id":"az-kgq","depends_on_id":"az-ee4","type":"parent-child","created_at":"2025-12-11T14:46:10.274456+11:00","created_by":"daemon"}]}
{"id":"az-kis","title":"Utility modules: paths, logger, tmux helpers","description":"Create foundational utility modules used throughout the codebase.","design":"- paths.ts: worktree path generation, project name extraction (pure functions)\n- logger.ts: Use Effect's built-in Logger service with custom formatting\n- tmux.ts: TmuxService as Effect.Service wrapping @effect/platform Command\n  - Methods: newSession, attachSession, sendKeys, listSessions, killSession\n  - Typed errors: TmuxNotFoundError, SessionNotFoundError\n- terminal.ts: TerminalService for detecting/launching terminal emulators\n  - Support Ghostty, iTerm, Terminal.app\n  - Returns Effect with TerminalNotFoundError","notes":"Session 2025-12-11:\n\nCOMPLETED:\n- TmuxService Effect service\n- TerminalService Effect service\n- paths.ts pure utility functions\n\nFILES CREATED:\n- src/core/TmuxService.ts (3.6KB) - tmux session management\n- src/core/TerminalService.ts (1.8KB) - terminal detection/launching\n- src/core/paths.ts (868B) - path utilities\n- src/core/example-usage.ts (2.5KB) - usage examples\n\nTMUX SERVICE METHODS:\n- newSession(name, opts?) - Create detached session\n- killSession(name) - Kill session\n- listSessions() - List with metadata (windows, created, attached)\n- hasSession(name) - Check existence\n- sendKeys(session, keys) - Send keystrokes\n- attachCommand(session) - Get attach command string\n\nTERMINAL SERVICE METHODS:\n- detect() - Returns \"ghostty\" | \"iterm\" | \"terminal-app\" | \"unknown\"\n- openWithCommand(cmd) - Opens new terminal window with command\n\nPATH UTILITIES:\n- getProjectName(path) - Extract basename\n- getWorktreePath(projectPath, beadId) - ../ProjectName-\u003cbeadId\u003e/\n- getSessionName(beadId) - Uses bead ID directly\n- normalizePath(path) - path.resolve()\n\nVERIFICATION:\n- All files compile with TypeScript strict mode","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:44:26.516814+11:00","updated_at":"2025-12-11T17:27:44.742141+11:00","closed_at":"2025-12-11T17:25:14.137924+11:00","dependencies":[{"issue_id":"az-kis","depends_on_id":"az-05y","type":"parent-child","created_at":"2025-12-11T14:46:08.116031+11:00","created_by":"daemon"},{"issue_id":"az-kis","depends_on_id":"az-ags","type":"blocks","created_at":"2025-12-11T14:46:25.747591+11:00","created_by":"daemon"}]}
{"id":"az-krz","title":"User documentation and guides","description":"Create comprehensive user documentation in docs/ folder covering TUI usage, keybindings, tmux integration, services architecture, and testing procedures.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:43:35.93321+11:00","updated_at":"2025-12-12T10:43:42.698148+11:00","closed_at":"2025-12-12T10:43:42.698148+11:00"}
{"id":"az-kzk","title":"Quick task creation from TUI","description":"Create new beads tasks without leaving the TUI.","design":"- 'n' key opens task creation modal\n- ink-text-input for title, description\n- Select type, priority from list\n- Optionally set dependencies\n- Calls bd create under the hood","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:42.159577+11:00","updated_at":"2025-12-12T12:20:02.57418+11:00","closed_at":"2025-12-12T12:20:02.57418+11:00","dependencies":[{"issue_id":"az-kzk","depends_on_id":"az-ee4","type":"parent-child","created_at":"2025-12-11T14:46:10.411847+11:00","created_by":"daemon"}]}
{"id":"az-l7a","title":"Agent Mail Integration for Multi-Agent Coordination","description":"Implement Agent Mail coordination layer for multi-agent beads workflows. Agent Mail reduces coordination latency from 2-5 seconds (git sync) to \u003c100ms (HTTP API), preventing work collisions when multiple Claude sessions operate simultaneously.\n\nKey benefits:\n- 20-50x faster coordination than git sync\n- Prevents duplicate work through exclusive file reservations\n- Lightweight (~50MB memory footprint)\n- Optional with graceful degradation to git-only\n\nIntegration points:\n1. Issue reservation before starting work\n2. Issue release when work completes\n3. Ready query to find unblocked, unreserved issues\n4. Status updates for real-time visibility\n\nConfiguration:\n- BEADS_AGENT_MAIL_URL: Server endpoint\n- BEADS_AGENT_NAME: Unique agent identifier\n- BEADS_PROJECT_ID: Shared namespace\n\nReference: https://github.com/steveyegge/beads/blob/main/docs/AGENT_MAIL.md","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-12T10:32:57.000556+11:00","updated_at":"2025-12-12T10:32:57.000556+11:00"}
{"id":"az-lqb","title":"Worker session template with epic context injection","description":"Create worker.md session template that injects:\n- Task title, description, design\n- Parent epic context (title, design, goals)\n- Coordination rules (stay focused, report discoveries)\n- bd commands for status updates\n\n**Template variables:** $TASK_ID, $TASK_TITLE, $EPIC_ID, $EPIC_TITLE, $EPIC_DESIGN\n\n**Location:** .claude/session-templates/worker.md","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:29:14.913748+11:00","updated_at":"2025-12-12T13:29:14.913748+11:00","dependencies":[{"issue_id":"az-lqb","depends_on_id":"az-gds","type":"parent-child","created_at":"2025-12-12T13:29:32.80298+11:00","created_by":"daemon"}]}
{"id":"az-moj","title":"State transition hooks system","description":"Pluggable hook system for state transition events.","design":"- Define HookRegistry as Effect.Service\n- Hook types as tagged union: onWaiting | onDone | onError | onPaused\n- Built-in hooks: NotificationHook, PRCreationHook, BeadsSyncHook\n- Methods:\n  - register(hookType, handler): Effect\u003cvoid\u003e\n  - trigger(hookType, context): Effect\u003cvoid\u003e\n- Use PubSub subscription for event-driven hooks\n- Hook handlers are Effects with typed context:\n  - HookContext = { task: Issue, session: Session, worktree: Worktree }\n- Use Effect.forEach with { concurrency: \"unbounded\" } for parallel hooks\n- User-configurable hooks via Config (shell commands)\n- Use Effect.catchAll for error isolation between hooks","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:24.613629+11:00","updated_at":"2025-12-11T14:54:42.476693+11:00","dependencies":[{"issue_id":"az-moj","depends_on_id":"az-zv6","type":"parent-child","created_at":"2025-12-11T14:46:09.589726+11:00","created_by":"daemon"},{"issue_id":"az-moj","depends_on_id":"az-xi5","type":"blocks","created_at":"2025-12-11T14:46:28.411943+11:00","created_by":"daemon"}]}
{"id":"az-mq9","title":"Create effect-atom SolidJS adapter","description":"Create a SolidJS adapter for effect-atom since only React and Vue adapters exist. This bridges Effect services to SolidJS's reactive system.","design":"- Create src/lib/effect-atom-solid/ adapter (or separate package later)\n- Core primitives to implement:\n  - `useAtomValue(atom)` ‚Üí uses SolidJS `from()` or `createSignal` + subscription\n  - `useAtomSet(atom)` ‚Üí returns setter function\n  - `useAtom(atom)` ‚Üí returns [Accessor, Setter] tuple\n  - `useAtomMount(atom)` ‚Üí lifecycle via `onMount`/`onCleanup`\n  - `createAtomResource(atom)` ‚Üí bridges to SolidJS `createResource` for Suspense\n- Use `RegistryContext` via SolidJS `createContext`/`useContext`\n- Leverage SolidJS's `from()` utility for external subscriptions\n- Pattern: subscribe to Atom changes, update SolidJS signal\n- Consider contributing back to tim-smart/effect-atom","notes":"Session 2025-12-11:\n\nCOMPLETED:\n- Full SolidJS adapter for @effect-atom/atom\n- Implements all core hooks matching React adapter API\n\nFILES CREATED:\n- src/lib/effect-atom-solid/hooks.ts - useAtomValue, useAtomSet, useAtom, useAtomMount, useAtomRefresh\n- src/lib/effect-atom-solid/Provider.tsx - AtomProvider with registry options\n- src/lib/effect-atom-solid/index.ts - Barrel exports\n- src/lib/effect-atom-solid/example.tsx - Working counter example\n- src/lib/effect-atom-solid/README.md - Full documentation\n\nKEY DECISIONS:\n- Used createSignal + subscription pattern (SolidJS equivalent of useSyncExternalStore)\n- Values returned as Accessor\u003cT\u003e (must call: count()) per SolidJS conventions\n- Default scheduler: queueMicrotask (not React Scheduler)\n- Used onCleanup for automatic subscription cleanup\n\nPOTENTIAL CONTRIBUTION:\n- This adapter could be contributed back to tim-smart/effect-atom\n- API surface mirrors @effect-atom/atom-react for easy migration","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T17:10:02.323692+11:00","updated_at":"2025-12-11T17:27:44.548067+11:00","closed_at":"2025-12-11T17:25:13.974746+11:00","dependencies":[{"issue_id":"az-mq9","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T17:10:08.844553+11:00","created_by":"daemon"},{"issue_id":"az-mq9","depends_on_id":"az-ags","type":"blocks","created_at":"2025-12-11T17:10:08.914278+11:00","created_by":"daemon"}]}
{"id":"az-om3","title":"WorktreeManager - git worktree lifecycle","description":"Manage git worktree creation, tracking, and cleanup for isolated task execution.","design":"- Define WorktreeManager as Effect.Service\n- Use @effect/platform Command for git operations (or simple-git if needed)\n- Naming: ../ProjectName-\u003cbead-id\u003e/\n- Methods return Effect with typed errors:\n  - create(beadId, baseBranch): Effect\u003cWorktree, GitError\u003e\n  - remove(beadId): Effect\u003cvoid, GitError | WorktreeNotFoundError\u003e\n  - list(): Effect\u003cWorktree[], GitError\u003e\n  - exists(beadId): Effect\u003cboolean, GitError\u003e\n- Use Effect.acquireRelease for cleanup guarantees\n- Track active worktrees in Ref\n- Handle epic vs task worktree sharing logic\n- Create WorktreeManagerLive and WorktreeManagerTest layers","notes":"Implemented WorktreeManager Effect service with:\n- Service interface with create, remove, list, exists, get methods\n- Error types: GitError, WorktreeNotFoundError, WorktreeExistsError, NotAGitRepoError\n- Idempotent create operation (safe to call multiple times)\n- Ref-based state tracking for active worktrees\n- Parses git worktree list --porcelain output\n- acquireRelease pattern via acquireWorktree for cleanup guarantees\n- Convenience functions for all operations\n- WorktreeManagerLive and WorktreeManagerLiveWithPlatform layers\n- Comprehensive example file with 7 usage patterns\n- Follows BeadsClient and TmuxService patterns\n- All type checks pass","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:44.585679+11:00","updated_at":"2025-12-11T18:03:13.741817+11:00","closed_at":"2025-12-11T18:03:13.741817+11:00","dependencies":[{"issue_id":"az-om3","depends_on_id":"az-d8z","type":"parent-child","created_at":"2025-12-11T14:46:08.224593+11:00","created_by":"daemon"}]}
{"id":"az-pn6","title":"StatusBar component","description":"Bottom status bar showing available actions and system status.","design":"- Fixed position at bottom\n- Show available keybindings for current context\n- Show connection status, sync status\n- Show count of running sessions\n- Responsive to terminal width","notes":"Enhanced StatusBar component with:\n1. Connection/sync status indicator (‚óè connected, ‚óã disconnected) using theme colors\n2. Responsive terminal width handling - hides keybinds \u003c100 cols, mode display \u003c80 cols, selected count \u003c60 cols\n3. Project name 'azedarach' displayed on left with bold styling\n4. Improved visual hierarchy using Catppuccin theme colors (green for connected, overlay0 for disconnected)\n5. Added optional 'connected' prop to StatusBarProps (defaults to true)\n6. Type-safe implementation - pnpm type-check passes with no errors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:07.987695+11:00","updated_at":"2025-12-12T01:29:02.416939+11:00","closed_at":"2025-12-12T01:29:02.416939+11:00","dependencies":[{"issue_id":"az-pn6","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:09.038999+11:00","created_by":"daemon"}]}
{"id":"az-pnx","title":"Configuration system with @effect/schema and Effect Config","description":"User configuration loading and validation.","design":"- Use Effect's built-in Config module for configuration\n- Use @effect/schema for config file validation (replaces zod)\n- Define ConfigSchema with Schema.Struct for type-safe config\n- Config sections: terminal, worktree, session, completion, notifications, patterns\n- Support multiple sources via Config.withDefault and Config.nested:\n  - Environment variables (AZEDARACH_*)\n  - Config files (.azedarach.json, .azedarachrc)\n  - package.json \"azedarach\" key\n- Create ConfigLive layer that loads and validates config\n- Sensible defaults for all options via Schema.withDefault","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:41.673276+11:00","updated_at":"2025-12-12T17:24:13.126088+11:00","closed_at":"2025-12-12T17:24:13.126088+11:00","dependencies":[{"issue_id":"az-pnx","depends_on_id":"az-ee4","type":"parent-child","created_at":"2025-12-11T14:46:10.015922+11:00","created_by":"daemon"}]}
{"id":"az-pza","title":"TUI \u0026 Interaction","description":"Ink-based terminal UI: Kanban board, keyboard navigation, session attachment, and user interaction flows.","notes":"Session 2025-12-12:\n\nEPIC PROGRESS: 6/7 tasks completed (86%)\n\nCOMPLETED CHILDREN:\n- az-hri: Basic Kanban board ‚úÖ\n- az-mq9: effect-atom SolidJS adapter ‚úÖ\n- az-t4t: Keyboard navigation (Helix-style) ‚úÖ\n- az-pn6: StatusBar component ‚úÖ\n- az-g19: Terminal attachment (external) ‚úÖ\n- az-srh: Detail view panel ‚úÖ\n\nREMAINING:\n- az-stv: Task actions (start/attach/pause/resume) - NOW UNBLOCKED\n  - Depends on SessionManager (az-xi5) which is now complete\n  - This is the final task to wire session lifecycle to TUI\n\nPHASE 2 STATUS:\nTUI is fully functional with all navigation, selection, task movement, and viewing features. Only session lifecycle integration remains.\n\nNEXT SESSION:\n- Complete az-stv to close this epic\n- Wire SessionManager.start/stop/pause/resume to keyboard actions\n- Add visual feedback for session states in TaskCard","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-11T14:44:04.871997+11:00","updated_at":"2025-12-12T10:54:04.23523+11:00","closed_at":"2025-12-12T10:54:04.23523+11:00"}
{"id":"az-qmo","title":"Add stop session action (Space+x)","description":"No way to stop/kill a running session from the TUI. Need Space+x to kill tmux session and mark task as idle.","design":"- Add stopSessionAtom using runtime.fn calling SessionManager.stop\n- Wire Space+x in action mode to call stopSession(task.id)\n- Confirm before stopping? Or just stop immediately\n- Show success toast 'Stopped session for {id}'\n- Refresh tasks after stop","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T11:42:23.169998+11:00","updated_at":"2025-12-12T11:43:10.52549+11:00","closed_at":"2025-12-12T11:43:10.52549+11:00"}
{"id":"az-shv","title":"Error toast notifications in TUI","description":"Show dismissible error toasts when actions fail (e.g., attach to non-existent session, start on non-idle task). Currently errors only go to console.error which users don't see.","design":"- Toast component: fixed position, auto-dismiss after 5s or on keypress\n- Error state atom: Array\u003c{id, message, timestamp}\u003e\n- Show in StatusBar area or floating overlay\n- Red background with error icon\n- Queue multiple errors, show oldest first","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T10:59:23.087691+11:00","updated_at":"2025-12-12T11:07:55.898746+11:00","closed_at":"2025-12-12T11:07:55.898746+11:00"}
{"id":"az-srh","title":"Detail view for selected task","description":"Expandable detail panel showing full task information.","design":"- Toggle with Enter or Tab on selected task\n- Show: title, description, design notes, acceptance criteria\n- Show: dependencies, PR link if exists\n- Show: recent session output (last N lines)\n- Show: available actions for current state","notes":"Implementation complete. Created DetailPanel.tsx component that shows full task details in a modal overlay. Added Enter key handler in normal mode to toggle the detail view. Updated HelpOverlay to document the Enter key. Component displays: task ID, type, priority, status, session state, description, design notes, notes, timestamps, and available actions based on task state. Follows same overlay pattern as HelpOverlay with semi-transparent background and centered box using Catppuccin theme colors.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T14:45:08.103114+11:00","updated_at":"2025-12-12T10:32:33.95362+11:00","closed_at":"2025-12-12T10:32:33.95362+11:00","dependencies":[{"issue_id":"az-srh","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:09.178011+11:00","created_by":"daemon"}]}
{"id":"az-stv","title":"Task actions: start, attach, pause, resume","description":"Implement keyboard shortcuts for task lifecycle actions.","design":"- Enter: start task (create worktree, spawn Claude)\n- a: attach to running session (opens external terminal)\n- A: attach inline (TUI shows session output)\n- p: pause session (interrupt, WIP commit)\n- r: resume paused session\n- Validate action is valid for current task state","notes":"Session 2025-12-12:\n\nNOW UNBLOCKED - All dependencies completed:\n- az-xi5 (SessionManager): ‚úÖ Closed - full orchestration service\n- az-t4t (Keyboard navigation): ‚úÖ Closed - Helix-style modal keybindings\n\nIMPLEMENTATION PLAN:\n1. Wire SessionManager to Action mode commands:\n   - Space+s: SessionManager.start() - create worktree + spawn Claude\n   - Space+a: Already done (AttachmentService.attachExternal)\n   - Space+p: SessionManager.pause() - Ctrl+C + WIP commit\n   - Space+r: SessionManager.resume() - reattach to paused session\n\n2. Update TaskCard to show live session state:\n   - Use SessionManager.subscribeToStateChanges() PubSub\n   - Update sessionState in TaskWithSession reactively\n   - Already have session indicators: üîµüü°‚úÖ‚ùå‚è∏Ô∏è\n\n3. Validate action availability:\n   - 's' only on idle tasks\n   - 'a' only on busy/waiting tasks\n   - 'p' only on busy tasks\n   - 'r' only on paused tasks\n\nDEPENDENCIES NOW MET:\n- SessionManager: src/core/SessionManager.ts\n- WorktreeManager: src/core/WorktreeManager.ts\n- TmuxService: src/core/TmuxService.ts\n- StateDetector: src/core/StateDetector.ts\n\nFILES TO MODIFY:\n- src/ui/App.tsx - Add action handlers for s/p/r\n- src/ui/atoms.ts - Add session lifecycle effects\n- src/ui/TaskCard.tsx - May need state subscription","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:07.880144+11:00","updated_at":"2025-12-12T10:53:49.478801+11:00","closed_at":"2025-12-12T10:53:49.478801+11:00","dependencies":[{"issue_id":"az-stv","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:08.920801+11:00","created_by":"daemon"},{"issue_id":"az-stv","depends_on_id":"az-xi5","type":"blocks","created_at":"2025-12-11T14:46:28.054522+11:00","created_by":"daemon"},{"issue_id":"az-stv","depends_on_id":"az-t4t","type":"blocks","created_at":"2025-12-11T14:46:28.161361+11:00","created_by":"daemon"}]}
{"id":"az-t4t","title":"Keyboard navigation (vim-style)","description":"Implement vim-style keyboard navigation for the Kanban board.","design":"- Use OpenTUI's input handling (onKeyPress or similar)\n- SolidJS signals for tracking selection state:\n  - selectedColumn: Accessor\u003cnumber\u003e\n  - selectedTask: Accessor\u003cnumber\u003e\n- h/‚Üê, l/‚Üí: navigate columns (setSelectedColumn)\n- j/‚Üì, k/‚Üë: navigate tasks within column (setSelectedTask)\n- Visual highlight via conditional styling\n- Wrap navigation at boundaries (or stop)\n- Create useKeyboardNavigation hook for reusability","notes":"Session 2025-12-11 (evening):\n\nCOMPLETED:\n- Full Helix-style modal keybinding system implemented\n- Normal mode: hjkl navigation, g‚Üígoto, v‚Üíselect, Space‚Üíaction menu\n- Goto mode: gw shows 2-char jump labels (home row keys), gg/ge first/last, gh/gl column ends\n- Select mode: multi-selection via Space toggle, hjkl navigation\n- Action mode: h/l moves task(s) to adjacent column (updates status via bd CLI)\n- Ctrl-d/Ctrl-u half-page scrolling\n- Catppuccin Mocha theme colors\n- Virtual scrolling: columns show maxVisible tasks based on terminal height\n- StatusBar shows mode (NOR/SEL/GTO/ACT) with contextual keybind hints\n\nFILES MODIFIED:\n- src/ui/types.ts - Added EditorMode, GotoSubMode, JumpTarget types, generateJumpLabels()\n- src/ui/App.tsx - Full modal state machine, keyboard handling, terminal height calculation\n- src/ui/Board.tsx - Added activeTaskIndex, terminalHeight props\n- src/ui/Column.tsx - Virtual scrolling with scroll indicators\n- src/ui/TaskCard.tsx - Simplified to avoid OpenTUI fragment bugs\n- src/ui/StatusBar.tsx - Mode indicator + contextual keybinds per mode\n- src/ui/theme.ts - Catppuccin Mocha color palette\n- src/ui/atoms.ts - moveTaskEffect, moveTasksEffect for task movement\n- README.md - Comprehensive Helix-style keybinding documentation\n\nISSUES FIXED:\n- client.ready() only returned open/unblocked tasks - changed to client.list()\n- OpenTUI JSX fragments caused rendering corruption - use single text elements\n- Column overflow - implemented virtual scrolling\n\nREMAINING:\n- Some minor rendering artifacts in first column (title-only cards occasionally)\n- Action mode only implements h/l (move) - s/a/p/r/d/P not yet implemented\n\nNEXT STEPS:\n- Could close this bead - core vim-style navigation is complete\n- Action mode commands (start session, attach, etc.) belong in az-stv (Task actions)\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:07.772639+11:00","updated_at":"2025-12-11T23:49:35.046226+11:00","closed_at":"2025-12-11T23:49:35.046226+11:00","dependencies":[{"issue_id":"az-t4t","depends_on_id":"az-pza","type":"parent-child","created_at":"2025-12-11T14:46:08.800764+11:00","created_by":"daemon"},{"issue_id":"az-t4t","depends_on_id":"az-hri","type":"blocks","created_at":"2025-12-11T14:46:26.269114+11:00","created_by":"daemon"}]}
{"id":"az-tgc","title":"Agent Mail configuration and environment","description":"Add configuration support for Agent Mail settings.\n\nDesign:\n- Environment variables:\n  - BEADS_AGENT_MAIL_URL (optional)\n  - BEADS_AGENT_NAME (defaults to hostname or generated)\n  - BEADS_PROJECT_ID (defaults to git remote or project path hash)\n- Config service using @effect/platform Config\n- Validation with @effect/schema\n- Auto-detect if Agent Mail server is available\n- CLI flag --agent-mail-url to override\n- Show Agent Mail status in TUI StatusBar","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T10:33:13.864792+11:00","updated_at":"2025-12-12T10:33:13.864792+11:00","dependencies":[{"issue_id":"az-tgc","depends_on_id":"az-l7a","type":"blocks","created_at":"2025-12-12T10:33:21.905172+11:00","created_by":"daemon"}]}
{"id":"az-uxz","title":"Action palette overlay for Space menu","description":"Action mode keybindings are getting crowded in the status bar. Create a proper floating action palette that appears when Space is pressed, showing all available actions with descriptions.","design":"- Floating box overlay (like HelpOverlay)\n- Show action, keybind, and short description\n- Gray out unavailable actions based on task state\n- e.g., 'Start' grayed if session already running\n- Dismiss on Esc or action execution\n- Consider grouping: Session (s/a/p/r/x), Move (h/l), etc.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T12:00:26.143992+11:00","updated_at":"2025-12-12T12:16:53.933473+11:00","closed_at":"2025-12-12T12:16:53.933473+11:00"}
{"id":"az-xi5","title":"SessionManager - Claude session orchestration","description":"Core orchestration: spawn Claude in tmux sessions, manage lifecycle, coordinate with worktrees.","design":"- Define SessionManager as Effect.Service\n- Depends on: WorktreeManager, TmuxService, BeadsClient, StateDetector, FileLockManager\n- Methods return Effect with typed errors:\n  - start(beadId): Effect\u003cSession, SessionError | WorktreeError\u003e\n  - stop(beadId): Effect\u003cvoid, SessionError\u003e\n  - pause(beadId): Effect\u003cvoid, SessionError\u003e // Ctrl+C, WIP commit\n  - resume(beadId): Effect\u003cvoid, SessionError\u003e\n  - getState(beadId): Effect\u003cSessionState, SessionError\u003e\n  - listActive(): Effect\u003cSession[], never\u003e\n- Use Effect.gen for orchestration flow\n- Use PubSub for state change events\n- Track sessions in Ref\u003cHashMap\u003cBeadId, Session\u003e\u003e\n- Create SessionManagerLive layer that composes dependencies","notes":"Implemented SessionManager service in src/core/SessionManager.ts following Effect service pattern.\n\nKey implementation details:\n- Service interface with 7 methods: start, stop, pause, resume, getState, listActive, updateState, subscribeToStateChanges\n- Uses Effect.gen pattern for orchestration\n- Composes WorktreeManager, TmuxService, BeadsClient, and StateDetector services\n- Tracks sessions in Ref\u003cHashMap\u003cBeadId, Session\u003e\u003e\n- PubSub for state change events\n- SessionManagerLive layer with all dependencies included\n- All methods require CommandExecutor in context (provided by BunContext layer)\n- Type-safe error handling with typed error unions\n- Comprehensive JSDoc documentation\n\nThe start() method creates worktree, spawns tmux session, and launches Claude.\nThe pause() method sends Ctrl+C and creates WIP commit.\nThe stop() method kills tmux session.\n\nAll types pass strict TypeScript checking (pnpm type-check).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:44:44.82144+11:00","updated_at":"2025-12-12T10:32:34.049829+11:00","closed_at":"2025-12-12T10:32:34.049829+11:00","dependencies":[{"issue_id":"az-xi5","depends_on_id":"az-d8z","type":"parent-child","created_at":"2025-12-11T14:46:08.3385+11:00","created_by":"daemon"},{"issue_id":"az-xi5","depends_on_id":"az-om3","type":"blocks","created_at":"2025-12-11T14:46:26.452316+11:00","created_by":"daemon"},{"issue_id":"az-xi5","depends_on_id":"az-kis","type":"blocks","created_at":"2025-12-11T14:46:26.845057+11:00","created_by":"daemon"},{"issue_id":"az-xi5","depends_on_id":"az-a8i","type":"blocks","created_at":"2025-12-11T14:46:27.560945+11:00","created_by":"daemon"}]}
{"id":"az-xw8","title":"Generate hooks config when spawning sessions","description":"SessionManager generates .claude/hooks.json in worktree when spawning sessions. Hooks auto-sync beads on Stop event and update issue notes. Pure bash-based automation without MCP overhead.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-12T13:25:00.000819+11:00","updated_at":"2025-12-12T13:25:20.656259+11:00","dependencies":[{"issue_id":"az-xw8","depends_on_id":"az-aiu","type":"blocks","created_at":"2025-12-12T13:25:32.748995+11:00","created_by":"daemon"}]}
{"id":"az-yf4","title":"PRWorkflow - automated GitHub PR creation","description":"Automate PR creation when tasks complete using gh CLI.\n\nDesign:\n- Define PRWorkflow as Effect.Service\n- Depends on: SessionManager, WorktreeManager, BeadsClient, Config\n- Use @effect/platform Command for git and gh CLI operations\n\nMethods:\n  - createPR(beadId): Effect\u003cPR, PRError | GitError\u003e\n  - getPR(beadId): Effect\u003cPR | null, PRError\u003e\n  - mergePR(prNumber): Effect\u003cvoid, PRError\u003e\n  - cleanup(beadId): Effect\u003cvoid, GitError\u003e -- NEW\n\nWorkflow on \"done\" state:\n  1. bd sync (via BeadsClient)\n  2. git add -A \u0026\u0026 git commit\n  3. git push -u origin \u003cbranch\u003e\n  4. gh pr create --draft --title \"...\" --body \"...\"\n\nPR body template includes bead description, acceptance criteria.\nLink PR back to bead via bd update --notes.\nUse Effect.retry with Schedule for transient failures.\n\n**Cleanup after merge:**\n  1. Ensure session is stopped\n  2. WorktreeManager.remove() - delete worktree directory\n  3. git push origin --delete \u003cbranch\u003e - delete remote branch\n  4. git branch -D \u003cbranch\u003e - delete local branch\n  5. bd close \u003cbeadId\u003e - mark task complete\n\nThis cleanup function will also be exposed for manual use (az-6t6).","design":"- Define PRWorkflow as Effect.Service\n- Depends on: SessionManager, BeadsClient, Config\n- Use @effect/platform Command for git and gh CLI operations\n- Methods:\n  - createPR(beadId): Effect\u003cPR, PRError | GitError\u003e\n  - getPR(beadId): Effect\u003cPR | null, PRError\u003e\n  - mergePR(prNumber): Effect\u003cvoid, PRError\u003e\n- Workflow on \"done\" state:\n  1. bd sync (via BeadsClient)\n  2. git add -A \u0026\u0026 git commit\n  3. git push -u origin \u003cbranch\u003e\n  4. gh pr create --draft --title \"...\" --body \"...\"\n- PR body template includes bead description, acceptance criteria\n- Link PR back to bead via bd update --notes\n- Use Effect.retry with Schedule for transient failures","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-11T14:45:24.509773+11:00","updated_at":"2025-12-12T12:30:29.541722+11:00","closed_at":"2025-12-12T12:30:29.541722+11:00","dependencies":[{"issue_id":"az-yf4","depends_on_id":"az-zv6","type":"parent-child","created_at":"2025-12-11T14:46:09.444969+11:00","created_by":"daemon"},{"issue_id":"az-yf4","depends_on_id":"az-xi5","type":"blocks","created_at":"2025-12-11T14:46:28.29207+11:00","created_by":"daemon"}]}
{"id":"az-zqi","title":"Full bead editor (Space+e)","description":"Open selected bead in $EDITOR with structured markdown format. Parse on save, validate structure, discard if invalid, update via bd CLI if valid.","design":"Format:\n```markdown\n# {id}: {title}\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\nType:     {type}        (read-only)\nPriority: {P0-P4}\nStatus:   {status}\nAssignee: {assignee}\nLabels:   {comma-separated}\nEstimate: {minutes}\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n## Description\n\n{description}\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n## Design\n\n{design}\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n## Notes\n\n{notes}\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n## Acceptance Criteria\n\n{acceptance}\n```\n\nValidation:\n- Header must match `# {id}: {title}`\n- Separator lines: 20+ ‚îÄ chars\n- Priority: P0-P4\n- Status: open|in_progress|blocked|closed\n- Section headers required\n\nFlow:\n1. Space+e ‚Üí write /tmp/azedarach-{id}.md\n2. Spawn $EDITOR (blocking)\n3. Parse markdown on return\n4. Validate ‚Üí show error toast if invalid\n5. Diff against original ‚Üí bd update changed fields\n6. Refresh tasksAtom","notes":"Type change handling:\nIf user changes Type: field (e.g., task ‚Üí epic), the editor must:\n1. Detect type changed during parse\n2. bd create --type=newType with all other fields ‚Üí get new ID\n3. Copy dependencies: bd dep add new-id (for each dep)\n4. bd delete old-id\n5. Navigate TUI to new bead\n\nThis is necessary because bd update cannot change issue_type after creation.\n\nFormat is Azedarach-owned since bd has no full-bead format - only per-field edit (bd edit --notes) or CLI flags (bd update --notes='...').","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T10:59:31.596266+11:00","updated_at":"2025-12-12T12:20:24.690791+11:00","closed_at":"2025-12-12T12:20:24.690791+11:00","dependencies":[{"issue_id":"az-zqi","depends_on_id":"az-shv","type":"blocks","created_at":"2025-12-12T10:59:35.281709+11:00","created_by":"daemon"}]}
{"id":"az-zv6","title":"Automation \u0026 Workflows","description":"Automated workflows: PR creation, state transition hooks, notifications, and beads sync coordination.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:44:04.97152+11:00","updated_at":"2025-12-11T14:44:04.97152+11:00"}
